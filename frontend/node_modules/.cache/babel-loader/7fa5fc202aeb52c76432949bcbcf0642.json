{"ast":null,"code":"import { call, put, takeEvery } from \"redux-saga/effects\";\nimport { push } from \"connected-react-router\";\nimport * as actionCreators from \"../actions\";\nimport * as modalActionCreators from \"../../common/ModalDialog/actions\";\nimport * as notificationActionCreators from \"../../common/Notifications/actions\";\nimport { USER, SIGN_IN_MODAL } from \"../constants\";\n\nconst request = ({\n  login,\n  password\n}) => {\n  return new Promise((resolve, reject) => {\n    return login === \"bob\" && password === \"123\" ? setTimeout(() => resolve(USER), 1000) : reject(new Error(\"Неверные данные\"));\n  });\n};\n\nfunction* signOut() {\n  try {\n    yield put(actionCreators.pendingData());\n    yield put(notificationActionCreators.removeAllNotifications());\n    yield put(notificationActionCreators.successNotification(\"Всего доброго до свидания\"));\n    yield put(push(\"/\"));\n  } catch (error) {\n    yield put(actionCreators.signOutFail());\n    yield put(notificationActionCreators.errorNotification(error.message));\n  }\n}\n\nfunction* signIn(action) {\n  try {\n    yield put(actionCreators.signInFail());\n    const user = yield call(request, action.payload);\n    yield signInSuccess(user);\n  } catch (error) {\n    yield put(actionCreators.signInFail());\n    yield put(notificationActionCreators.errorNotification(error.message));\n  }\n}\n\nfunction* signInSuccess(user) {\n  yield put(actionCreators.signInSuccess(user));\n  yield put(notificationActionCreators.removeAllNotifications());\n  yield put(notificationActionCreators.successNotification(\"Вход успешно выполнен!\"));\n  yield put(modalActionCreators.toggleModal(SIGN_IN_MODAL.modalName));\n  yield put(push(\"/account\"));\n}\n\nfunction* sendRequest() {\n  yield takeEvery(actionCreators.signInRequest, signIn);\n  yield takeEvery(actionCreators.signOutRequest, signOut);\n}\n\nexport default sendRequest;","map":{"version":3,"sources":["D:\\projects\\mern-kinopoisk\\frontend\\src\\modules\\auth\\sagas\\index.js"],"names":["call","put","takeEvery","push","actionCreators","modalActionCreators","notificationActionCreators","USER","SIGN_IN_MODAL","request","login","password","Promise","resolve","reject","setTimeout","Error","signOut","pendingData","removeAllNotifications","successNotification","error","signOutFail","errorNotification","message","signIn","action","signInFail","user","payload","signInSuccess","toggleModal","modalName","sendRequest","signInRequest","signOutRequest"],"mappings":"AAAA,SAASA,IAAT,EAAeC,GAAf,EAAoBC,SAApB,QAAqC,oBAArC;AACA,SAASC,IAAT,QAAqB,wBAArB;AAEA,OAAO,KAAKC,cAAZ,MAAgC,YAAhC;AACA,OAAO,KAAKC,mBAAZ,MAAqC,kCAArC;AACA,OAAO,KAAKC,0BAAZ,MAA4C,oCAA5C;AACA,SAASC,IAAT,EAAeC,aAAf,QAAoC,cAApC;;AAEA,MAAMC,OAAO,GAAG,CAAC;AAAEC,EAAAA,KAAF;AAASC,EAAAA;AAAT,CAAD,KAAyB;AACvC,SAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,WAAOJ,KAAK,KAAK,KAAV,IAAmBC,QAAQ,KAAK,KAAhC,GACHI,UAAU,CAAC,MAAMF,OAAO,CAACN,IAAD,CAAd,EAAsB,IAAtB,CADP,GAEHO,MAAM,CAAC,IAAIE,KAAJ,CAAU,iBAAV,CAAD,CAFV;AAGD,GAJM,CAAP;AAKD,CAND;;AAQA,UAAUC,OAAV,GAAoB;AAClB,MAAI;AACF,UAAMhB,GAAG,CAACG,cAAc,CAACc,WAAf,EAAD,CAAT;AACA,UAAMjB,GAAG,CAACK,0BAA0B,CAACa,sBAA3B,EAAD,CAAT;AACA,UAAMlB,GAAG,CACPK,0BAA0B,CAACc,mBAA3B,CACE,2BADF,CADO,CAAT;AAKA,UAAMnB,GAAG,CAACE,IAAI,CAAC,GAAD,CAAL,CAAT;AACD,GATD,CASE,OAAOkB,KAAP,EAAc;AACd,UAAMpB,GAAG,CAACG,cAAc,CAACkB,WAAf,EAAD,CAAT;AACA,UAAMrB,GAAG,CAACK,0BAA0B,CAACiB,iBAA3B,CAA6CF,KAAK,CAACG,OAAnD,CAAD,CAAT;AACD;AACF;;AAED,UAAUC,MAAV,CAAiBC,MAAjB,EAAyB;AACvB,MAAI;AACF,UAAMzB,GAAG,CAACG,cAAc,CAACuB,UAAf,EAAD,CAAT;AACA,UAAMC,IAAI,GAAG,MAAM5B,IAAI,CAACS,OAAD,EAAUiB,MAAM,CAACG,OAAjB,CAAvB;AACA,UAAMC,aAAa,CAACF,IAAD,CAAnB;AACD,GAJD,CAIE,OAAOP,KAAP,EAAc;AACd,UAAMpB,GAAG,CAACG,cAAc,CAACuB,UAAf,EAAD,CAAT;AACA,UAAM1B,GAAG,CAACK,0BAA0B,CAACiB,iBAA3B,CAA6CF,KAAK,CAACG,OAAnD,CAAD,CAAT;AACD;AACF;;AAED,UAAUM,aAAV,CAAwBF,IAAxB,EAA8B;AAC5B,QAAM3B,GAAG,CAACG,cAAc,CAAC0B,aAAf,CAA6BF,IAA7B,CAAD,CAAT;AACA,QAAM3B,GAAG,CAACK,0BAA0B,CAACa,sBAA3B,EAAD,CAAT;AACA,QAAMlB,GAAG,CACPK,0BAA0B,CAACc,mBAA3B,CAA+C,wBAA/C,CADO,CAAT;AAGA,QAAMnB,GAAG,CAACI,mBAAmB,CAAC0B,WAApB,CAAgCvB,aAAa,CAACwB,SAA9C,CAAD,CAAT;AACA,QAAM/B,GAAG,CAACE,IAAI,CAAC,UAAD,CAAL,CAAT;AACD;;AAED,UAAU8B,WAAV,GAAwB;AACtB,QAAM/B,SAAS,CAACE,cAAc,CAAC8B,aAAhB,EAA+BT,MAA/B,CAAf;AACA,QAAMvB,SAAS,CAACE,cAAc,CAAC+B,cAAhB,EAAgClB,OAAhC,CAAf;AACD;;AAED,eAAegB,WAAf","sourcesContent":["import { call, put, takeEvery } from \"redux-saga/effects\";\r\nimport { push } from \"connected-react-router\";\r\n\r\nimport * as actionCreators from \"../actions\";\r\nimport * as modalActionCreators from \"../../common/ModalDialog/actions\";\r\nimport * as notificationActionCreators from \"../../common/Notifications/actions\";\r\nimport { USER, SIGN_IN_MODAL } from \"../constants\";\r\n\r\nconst request = ({ login, password }) => {\r\n  return new Promise((resolve, reject) => {\r\n    return login === \"bob\" && password === \"123\"\r\n      ? setTimeout(() => resolve(USER), 1000)\r\n      : reject(new Error(\"Неверные данные\"));\r\n  });\r\n};\r\n\r\nfunction* signOut() {\r\n  try {\r\n    yield put(actionCreators.pendingData());\r\n    yield put(notificationActionCreators.removeAllNotifications());\r\n    yield put(\r\n      notificationActionCreators.successNotification(\r\n        \"Всего доброго до свидания\"\r\n      )\r\n    );\r\n    yield put(push(\"/\"));\r\n  } catch (error) {\r\n    yield put(actionCreators.signOutFail());\r\n    yield put(notificationActionCreators.errorNotification(error.message));\r\n  }\r\n}\r\n\r\nfunction* signIn(action) {\r\n  try {\r\n    yield put(actionCreators.signInFail());\r\n    const user = yield call(request, action.payload);\r\n    yield signInSuccess(user);\r\n  } catch (error) {\r\n    yield put(actionCreators.signInFail());\r\n    yield put(notificationActionCreators.errorNotification(error.message));\r\n  }\r\n}\r\n\r\nfunction* signInSuccess(user) {\r\n  yield put(actionCreators.signInSuccess(user));\r\n  yield put(notificationActionCreators.removeAllNotifications());\r\n  yield put(\r\n    notificationActionCreators.successNotification(\"Вход успешно выполнен!\")\r\n  );\r\n  yield put(modalActionCreators.toggleModal(SIGN_IN_MODAL.modalName));\r\n  yield put(push(\"/account\"));\r\n}\r\n\r\nfunction* sendRequest() {\r\n  yield takeEvery(actionCreators.signInRequest, signIn);\r\n  yield takeEvery(actionCreators.signOutRequest, signOut);\r\n}\r\n\r\nexport default sendRequest;\r\n"]},"metadata":{},"sourceType":"module"}